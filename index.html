<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NBA Rookie Rankings — Composite Leaderboard</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <header class="site-header">
    <div class="logo">
      <div class="logo-mark">NR</div>
      <div class="logo-text">NBA Rookie Rankings</div>
    </div>
    <div class="tagline">Your one-stop shop for NBA rookie comparisons</div>
  </header>

  <main class="container">
    <section class="controls">
      <input id="search" placeholder="Search player or team..." />
      <select id="sort">
        <option value="composite">Sort: Composite Rank</option>
        <option value="avg">Sort: Average Rank</option>
        <option value="name">Sort: Player Name</option>
        <option value="team">Sort: Team</option>
      </select>
    </section>

    <section id="leaderboard">
      <table class="leaderboard" id="leaderboard-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Player</th>
            <th>Team</th>
            <th>Composite</th>
            <th>Avg Rank</th>
            <th class="sources">ESPN</th>
            <th class="sources">Bleacher</th>
            <th class="sources">CBS</th>
            <th class="sources">NBA.com</th>
            <th>PPG</th>
            <th>RPG</th>
            <th>APG</th>
          </tr>
        </thead>
        <tbody id="table-body"></tbody>
      </table>
    </section>

    <section class="notes">
      <h3>About this version</h3>
      <p>This version pulls live rookie rankings (aggregated weekly) and daily stats from balldontlie.io. If a source is unavailable, we fall back to cached/mock data. This code is intended for deployment on Vercel (serverless API endpoints in <code>/api</code>).</p>
    </section>
  </main>

  <footer class="site-footer">
    <div>Built for <strong>nbarookierankings.com</strong></div>
    <div>Prototype v2 — live data (serverless APIs)</div>
  </footer>

<script>
async function fetchData(){
  try{
    const [rRes, sRes] = await Promise.all([fetch('/api/rankings'), fetch('/api/stats')]);
    const rankings = await rRes.json();
    const stats = await sRes.json();
    const top = rankings.top10;
    const tbody = document.getElementById('table-body');
    tbody.innerHTML='';
    top.forEach((p, idx)=>{
      const st = stats[p.name] || {pts:'—', reb:'—', ast:'—'};
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${idx+1}</td>
        <td class="player-cell"><div class="player-avatar">${p.name.split(' ').map(n=>n[0]).slice(0,2).join('')}</div><div><div style="font-weight:600">${p.name}</div><div style="color:#6b7280;font-size:12px">${p.team}</div></div></td>
        <td>${p.team}</td>
        <td><strong>${p.composite.toFixed(2)}</strong></td>
        <td>${p.avg.toFixed(2)}</td>
        <td class="sources">${p.espn||'—'}</td>
        <td class="sources">${p.bleacher||'—'}</td>
        <td class="sources">${p.cbs||'—'}</td>
        <td class="sources">${p.nba||'—'}</td>
        <td>${st.pts}</td>
        <td>${st.reb}</td>
        <td>${st.ast}</td>
      `;
      tbody.appendChild(tr);
    });
  }catch(err){
    console.error(err);
    document.getElementById('table-body').innerHTML = '<tr><td colspan="12">Error loading data. Try again later.</td></tr>';
  }
}

document.getElementById('search').addEventListener('input', ()=>{});
document.getElementById('sort').addEventListener('change', ()=>{});

fetchData();
</script>
</body>
</html>
